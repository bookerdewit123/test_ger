# Formats headers and corresponding data
script string joinObserverOutputs(Array<string> words, string type)
   # @param Array<string> words: The data to be formatted
   # @param string type: The type of data; 'header' or 'data'
   # @return: string of headers or data
   Map<string, bool>allowableTypes = {"header" : true, "data" : true};
   assert(allowableTypes.Exists(type), "*****ERROR - unknown type in joinObserverOutputs");
   if (type == "header")
   {
      return "HEADER".Join(words) + "\n";
   }
   else if (type == "data")
   {
      return  "DATA".Join(words) + "\n";
   }
   writeln("***** WARNING: unkonwn type.");
   return "";
end_script

# This function is used on simulation complete to format the event data and output it to the csv
script void generateOutputFile(string filePrefix, Array<string>headerNames, Array<string> dataLines, string PATH_TO_OUTPUT)
   # @param string filePrefix: What the file should be named
   # @param Array<string>headerNames: The names for the table headers in the output file csv
   # @param Array<string> dataLines: The data to be output to csv rows
   # @param string PATH_TO_OUTPUT: Where to store the csv
   # @return: None
   FileIO outfile = FileIO();
   string filename = filePrefix + ".csv";
   if (!outfile.Open(filename, "append"))
   {
      filename = PATH_TO_OUTPUT + filename;
   }
   if (WsfSimulation.RunNumber() > 1)
   {
      outfile.Open(filename, "append");
   }
   else
   {
      outfile.Open(filename, "out");
      outfile.Write(",".Join(headerNames) + "\n");
   }
   foreach (string csv_line in dataLines)
   {
      Array<string> out_array = {csv_line};
      outfile.Write(joinObserverOutputs(out_array, "data"));
   }
   outfile.Close();
end_script